{"version":3,"file":"server.js","names":["_react","require","_constants","_utils","_jsxRuntime","SELF_CLOSING_TAGS","TAG_NAMES","NOSCRIPT","SCRIPT","STYLE","encodeSpecialCharacters","str","encode","arguments","length","undefined","String","replace","generateElementAttributesAsString","attrs","res","name","value","Object","entries","attr","propToAttr","neu","generateTitleAsString","title","attrsStr","flattenedTitle","flattenArray","HELMET_ATTRIBUTE","generateTagsAsString","type","tags","tag","attributeHtml","TAG_PROPERTIES","INNER_HTML","CSS_TEXT","attrName","HTML_TAG_MAP","tagContent","innerHTML","cssText","isSelfClosing","includes","mapElementAttributesToProps","attributes","ops","addHelmetDataAttr","addKey","key","propName","REACT_TAG_MAP","dangerouslySetInnerHTML","__html","renderTitle","jsx","children","renderElement","createElement","renderElements","i","push","newServerState","heap","getState","state","calcAggregatedState","helmets","base","toComponent","props","toString","s","bodyAttributes","htmlAttributes","link","links","meta","noscript","priority","script","style","titleAttributes"],"sources":["../../src/server.tsx"],"sourcesContent":["import {\n  type HTMLAttributes,\n  type Key,\n  type ReactNode,\n  createElement,\n} from 'react';\n\nimport {\n  HELMET_ATTRIBUTE,\n  TAG_NAMES,\n  REACT_TAG_MAP,\n  TAG_PROPERTIES,\n  HTML_TAG_MAP,\n} from './constants';\n\nimport type {\n  HelmetProviderHeap,\n  HelmetServerState,\n  ScriptProps,\n  StyleProps,\n  TitleProps,\n} from './types';\n\nimport {\n  calcAggregatedState,\n  flattenArray,\n  propToAttr,\n} from './utils';\n\nconst SELF_CLOSING_TAGS: string[] = [\n  TAG_NAMES.NOSCRIPT,\n  TAG_NAMES.SCRIPT,\n  TAG_NAMES.STYLE,\n];\n\nconst encodeSpecialCharacters = (str: string, encode = true) => {\n  if (!encode) return str;\n\n  return String(str)\n    .replace(/&/g, '&amp;')\n    .replace(/</g, '&lt;')\n    .replace(/>/g, '&gt;')\n    .replace(/\"/g, '&quot;')\n    .replace(/'/g, '&#x27;');\n};\n\nfunction generateElementAttributesAsString<T>(\n  attrs: HTMLAttributes<T>,\n): string {\n  let res: string = '';\n\n  for (const [name, value] of Object.entries(attrs)) {\n    const attr = propToAttr(name);\n    const neu = value === undefined ? attr : `${attr}=\"${value}\"`;\n    if (neu && res) res += ' ';\n    res += neu;\n  }\n\n  return res;\n}\n\nconst generateTitleAsString = (\n  title: string,\n  attrs: TitleProps,\n  encode: boolean,\n) => {\n  let attrsStr = generateElementAttributesAsString(attrs);\n  if (attrsStr) attrsStr = ` ${attrsStr}`;\n\n  const flattenedTitle = flattenArray(title);\n\n  return `<title ${HELMET_ATTRIBUTE}=\"true\"${attrsStr}>${\n    encodeSpecialCharacters(flattenedTitle, encode)\n  }</title>`;\n};\n\nfunction generateTagsAsString<T>(\n  type: string,\n  tags: Array<HTMLAttributes<T>>,\n  encode: boolean,\n): string {\n  let res = '';\n\n  for (const tag of tags) {\n    let attributeHtml = '';\n\n    const entries = Object.entries(tag);\n    for (const [name, value] of entries) {\n      if (!(name === TAG_PROPERTIES.INNER_HTML as string\n        || name === TAG_PROPERTIES.CSS_TEXT as string)) {\n        const attrName = HTML_TAG_MAP[name] ?? name;\n        const attr = value === undefined ? attrName : `${attrName}=\"${encodeSpecialCharacters(value as string, encode)}\"`;\n        if (attributeHtml) attributeHtml += ` ${attr}`;\n        else attributeHtml = attr;\n      }\n    }\n\n    const tagContent = (tag as ScriptProps).innerHTML ?? (tag as StyleProps).cssText ?? '';\n\n    const isSelfClosing = !SELF_CLOSING_TAGS.includes(type);\n\n    res += `<${type} ${HELMET_ATTRIBUTE}=\"true\" ${attributeHtml}${\n      isSelfClosing ? '/>' : `>${tagContent}</${type}>`\n    }`;\n  }\n\n  return res;\n}\n\n/**\n * Given a map of element attribute names & values it returns the corresponding\n * map of element properties & values (i.e. replacing some attribute names by\n * their corresponding property names).\n */\n\nfunction mapElementAttributesToProps<T>(\n  attributes: HTMLAttributes<T>,\n  ops: { addHelmetDataAttr?: boolean; addKey?: Key } = {},\n): Record<string, unknown> {\n  const res: Record<string, unknown> = {};\n  if (ops.addHelmetDataAttr) res[HELMET_ATTRIBUTE] = true;\n  if (ops.addKey !== undefined) res.key = ops.addKey;\n  for (const [attrName, value] of Object.entries(attributes)) {\n    const propName = REACT_TAG_MAP[attrName] ?? attrName;\n\n    switch (propName) {\n      // cssText and innerHTML props get a special treatment to avoid that React\n      // escapes their values.\n      case 'cssText':\n      case 'innerHTML':\n        res.dangerouslySetInnerHTML = { __html: value as unknown };\n        break;\n      default:\n        res[propName] = value;\n    }\n  }\n  return res;\n}\n\nfunction renderTitle(title: string, attrs: TitleProps): ReactNode {\n  // NOTE: Rendered as array to match legacy behavior.\n  return [\n    <title\n      key={title}\n      // TODO: Can we avoid violating the rule?\n      // eslint-disable-next-line react/jsx-props-no-spreading\n      {...mapElementAttributesToProps(attrs, { addHelmetDataAttr: true })}\n    >\n      {title}\n    </title>,\n  ];\n}\n\nfunction renderElement<T>(\n  type: string,\n  attrs: HTMLAttributes<T>,\n  key?: Key,\n): ReactNode {\n  return createElement(type, mapElementAttributesToProps(attrs, {\n    addHelmetDataAttr: true,\n    addKey: key,\n  }));\n}\n\nfunction renderElements<T>(\n  type: string,\n  attrs: Array<HTMLAttributes<T>>,\n): ReactNode[] {\n  const res: ReactNode[] = [];\n  for (let i = 0; i < attrs.length; ++i) {\n    res.push(renderElement(type, attrs[i]!, i));\n  }\n  return res;\n}\n\nexport function newServerState(heap: HelmetProviderHeap): HelmetServerState {\n  // TODO: Should this function to be attached to the heap itself?\n  const getState = () => {\n    heap.state ??= calcAggregatedState(heap.helmets);\n    return heap.state;\n  };\n\n  return {\n    base: {\n      toComponent() {\n        const props = getState().base;\n        return props ? renderElements('base', [props]) : [];\n      },\n      toString() {\n        const s = getState();\n        return s.base ? generateTagsAsString('base', [s.base], s.encodeSpecialCharacters) : '';\n      },\n    },\n    bodyAttributes: {\n      toComponent() {\n        const props = getState().bodyAttributes;\n        return mapElementAttributesToProps(props ?? {});\n      },\n      toString() {\n        const props = getState().bodyAttributes;\n        return generateElementAttributesAsString(props ?? {});\n      },\n    },\n    htmlAttributes: {\n      toComponent() {\n        const props = getState().htmlAttributes;\n        return mapElementAttributesToProps(props ?? {});\n      },\n      toString() {\n        const props = getState().htmlAttributes;\n        return generateElementAttributesAsString(props ?? {});\n      },\n    },\n    link: {\n      toComponent() {\n        return renderElements('link', getState().links ?? []);\n      },\n      toString() {\n        const s = getState();\n        return generateTagsAsString('link', s.links ?? [], s.encodeSpecialCharacters);\n      },\n    },\n    meta: {\n      toComponent() {\n        return renderElements('meta', getState().meta ?? []);\n      },\n      toString() {\n        const s = getState();\n        return generateTagsAsString('meta', s.meta ?? [], s.encodeSpecialCharacters);\n      },\n    },\n    noscript: {\n      toComponent() {\n        return renderElements('noscript', getState().noscript ?? []);\n      },\n      toString() {\n        const s = getState();\n        return generateTagsAsString('noscript', s.noscript ?? [], s.encodeSpecialCharacters);\n      },\n    },\n    priority: {\n      toComponent() {\n        const s = getState();\n        return [\n          ...renderElements('meta', s.priority?.meta ?? []),\n          ...renderElements('link', s.priority?.links ?? []),\n          ...renderElements('script', s.priority?.script ?? []),\n        ];\n      },\n      toString() {\n        const s = getState();\n        const meta = generateTagsAsString('meta', s.priority?.meta ?? [], s.encodeSpecialCharacters);\n        const link = generateTagsAsString('link', s.priority?.links ?? [], s.encodeSpecialCharacters);\n        const script = generateTagsAsString('script', s.priority?.script ?? [], s.encodeSpecialCharacters);\n\n        let res = meta;\n        if (link) {\n          if (res) res += ' ';\n          res += link;\n        }\n        if (script) {\n          if (res) res += ' ';\n          res += script;\n        }\n\n        return res;\n      },\n    },\n    script: {\n      toComponent() {\n        return renderElements('script', getState().script ?? []);\n      },\n      toString() {\n        const s = getState();\n        return generateTagsAsString('script', s.script ?? [], s.encodeSpecialCharacters);\n      },\n    },\n    style: {\n      toComponent() {\n        return renderElements('style', getState().style ?? []);\n      },\n      toString() {\n        const s = getState();\n        return generateTagsAsString('style', s.style ?? [], s.encodeSpecialCharacters);\n      },\n    },\n    title: {\n      toComponent(): ReactNode {\n        const s = getState();\n        return renderTitle(s.title ?? '', s.titleAttributes ?? {});\n      },\n      toString() {\n        const s = getState();\n        return generateTitleAsString(s.title ?? '', s.titleAttributes ?? {}, s.encodeSpecialCharacters);\n      },\n    },\n  };\n}\n"],"mappings":"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","ignoreList":[]}